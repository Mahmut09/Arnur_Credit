{"variables":{"variable_buffer":{},"global_variables":{"path_to_unload_excel":"C:\\Users\\А-Бизнес\\Desktop\\ArnurCredit\\Провизия Арнур\\Открытые займы 30.11.2023 НЕ редактированная .xlsx","without_GESF":[],"GESF_values_list":[],"test_excel_path":"C:\\Users\\А-Бизнес\\Desktop\\ArnurCredit\\test.xlsx"}},"actions":{"rH9SV-HUyT":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"{{GESF_values_list}}.append(float({%-KwFfAOszI%}))"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"y0rGPS2FVo"},"-KwFfAOszI":{"name":"GET TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"WebElement","function":"get_text","class_params":{"selector":"/html/body/div[4]/div[3]/section[1]/div/div/div[2]/div[8]/b","driver":"","by":"xpath"},"func_params":{"delay_before":1,"delay_after":1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"rH9SV-HUyT"},"DP4gXWequd":{"name":"WEB CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"WebElement","function":"click","class_params":{"selector":"/html/body/div[4]/div[2]/div[1]/div/div[1]/a[2]","driver":"","by":"xpath"},"func_params":{"delay_before":2,"delay_after":1,"scroll":false},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"-KwFfAOszI"},"yEJDxwqTPq":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"file = open('C:\\\\Users\\\\А-Бизнес\\\\Desktop\\\\ArnurCredit\\\\Не найденные контракты.txt', 'w')\r\n\r\nfile.write(f'{{{data}}[{{i}}]}\\n')\r\n\r\nfile.close()"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"finish"},"hHU5V1-upY":{"name":"WEB CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"WebElement","function":"click","class_params":{"selector":"/html/body/div[4]/div[1]/div[2]/div/div[3]/a","driver":"","by":"xpath"},"func_params":{"delay_before":2,"delay_after":1,"scroll":false},"breakpoint":false,"if_error":{"go_to":"yEJDxwqTPq","repeat":null,"counter":0,"delay":null},"next_id":"DP4gXWequd"},"Ik6PLZOOi0":{"name":"SET VALUE","module":"pyPythonRPA.Robot.pythonRPA","class":"WebElement","function":"set_value","class_params":{"selector":"/html/body/div[4]/div[1]/div[2]/div/div[1]/input","driver":"","by":"xpath"},"func_params":{"value":"{{data}}[{{i}}]","delay_before":1,"delay_after":1,"click_flag":true},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"hHU5V1-upY"},"ehmooMzU-K":{"name":"WEB CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"WebElement","function":"click","class_params":{"selector":"/html/body/div[4]/div[1]/div[2]/div/div[2]/div/div[2]/div[2]","driver":"","by":"xpath"},"func_params":{"delay_before":3,"delay_after":1,"scroll":false},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"Ik6PLZOOi0"},"RfsZXBgutq":{"name":"WEB CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"WebElement","function":"click","class_params":{"selector":"/html/body/div[4]/div[1]/div[2]/div/div[2]/div/div[1]","driver":"","by":"xpath"},"func_params":{"delay_before":2,"delay_after":1,"scroll":false},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"ehmooMzU-K"},"Ru3_H8nXqE":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"import pandas as pd\r\n\r\ndef insert_GESF_value(df, without_GESF_list, replacement_values):\r\n    if len(without_GESF_list) != len(replacement_values):\r\n        print(\"Размеры не совпадают\")\r\n        return df\r\n    indices_to_replace = df[df['Контракт'].isin(without_GESF_list)].index\r\n    df.loc[indices_to_replace, 'Ставка ГЭСВ'] = replacement_values\r\n\r\n    return df\r\n\r\ndf = pd.read_excel({{test_excel_path}})\r\n\r\ninsert_GESF_value(df, {{data}}, {{GESF_values_list}})\r\ndf.to_excel({{test_excel_path}}, index=False)"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"finish"},"zSknOBV3tz":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"__return__ = {{data}}"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"Ru3_H8nXqE"},"y0rGPS2FVo":{"name":"FOR..I","module":"pyPythonRPA.Robot.pythonRPA","class":"loop","function":"for_i","class_params":{},"func_params":{"range":["len({{data}})"],"true_case":"RfsZXBgutq","false_case":"zSknOBV3tz","index_name":"i","state":{"iteration":0,"i":0,"initial_state":true}},"state":{"iteration":0,"i":0,"initial_state":true},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"condition"},"LZfVDrFxNg":{"name":"OPEN URL","module":"pyPythonRPA.Robot.pythonRPA","class":"Web","function":"get","class_params":{"driver_path":null,"download_path":null},"func_params":{"url":"https://ui.arnurcredit.kz/3/main/contracts"},"breakpoint":false,"inherit_object":"4DKCA9lXZf","if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"y0rGPS2FVo"},"XyNTmozkmx":{"name":"WEB CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"WebElement","function":"click","class_params":{"selector":"/html/body/div[1]/div[2]/div[2]/div[2]/form/div[2]/button","driver":"","by":"xpath"},"func_params":{"delay_before":1,"delay_after":1,"scroll":false},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"LZfVDrFxNg"},"ETY3IhxFGb":{"name":"SET VALUE","module":"pyPythonRPA.Robot.pythonRPA","class":"WebElement","function":"set_value","class_params":{"selector":"/html/body/div[1]/div[2]/div[2]/div[2]/form/div[1]/div[2]/div/div/input","driver":"","by":"xpath"},"func_params":{"value":"1qS8PFar","delay_before":1,"delay_after":1,"click_flag":true},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"XyNTmozkmx"},"tXr58UHW4t":{"name":"SET VALUE","module":"pyPythonRPA.Robot.pythonRPA","class":"WebElement","function":"set_value","class_params":{"selector":"/html/body/div[1]/div[2]/div[2]/div[2]/form/div[1]/div[1]/div/div/input","driver":"","by":"xpath"},"func_params":{"value":"rpa","delay_before":1,"delay_after":1,"click_flag":true},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"ETY3IhxFGb"},"Ef6Wz9VXNy":{"name":"OPEN URL","module":"pyPythonRPA.Robot.pythonRPA","class":"Web","function":"get","class_params":{"driver_path":null,"download_path":null},"func_params":{"url":"https://ui.arnurcredit.kz/"},"breakpoint":false,"inherit_object":"4DKCA9lXZf","if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"tXr58UHW4t"},"4DKCA9lXZf":{"start":true,"name":"OPEN BROWSER","module":"pyPythonRPA.Robot.pythonRPA","class":"Web","function":"open_browser","class_params":{"driver_path":"C:\\Program Files\\ChromeWithDriver\\chromedriver.exe","download_path":null},"func_params":{"name":"browser_1"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"Ef6Wz9VXNy"}},"configs":{},"credentials":{}}