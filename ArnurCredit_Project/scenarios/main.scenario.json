{"bvecGWKOCG":{"x":60,"y":120,"type":"start","connections":{"inputs":{"actionPort":[{"nodeId":"TRkRLbZawK","portName":"actionPort"}]},"outputs":{}},"inputData":{"actionPort":{}},"expanded":true,"root":true,"actions":{"data":{}},"id":"bvecGWKOCG"},"YQ3J7lgsgk":{"id":"YQ3J7lgsgk","x":540,"y":120,"type":"script_start","connections":{"inputs":{"nextAction":[{"nodeId":"IXRmy_SLYS","portName":"actionPort"}]},"outputs":{"actionPort":[{"nodeId":"TRkRLbZawK","portName":"nextAction"}]}},"inputData":{"jsonPath":{"path":"C:\\Users\\А-Бизнес\\Desktop\\Arnur_Credit\\ArnurCredit_Project\\scripts\\ArnurCredit_Project.edit_unloading_excel.script.json"},"nextAction":{},"params":{"params":""},"errorPort":{"repeat":null,"delay":null},"errorAction":{}},"expanded":true,"actions":{"data":{"breakpoint":false}},"comment":"Редактируем выгрузку ексель"},"LZhgig-Q9h":{"id":"LZhgig-Q9h","x":1140,"y":120,"type":"script_start","connections":{"inputs":{"nextAction":[{"nodeId":"ae2UtQP6wB","portName":"actionPort"}]},"outputs":{"actionPort":[{"nodeId":"IXRmy_SLYS","portName":"nextAction"}]}},"inputData":{"jsonPath":{"path":"C:\\Users\\А-Бизнес\\Desktop\\Arnur_Credit\\ArnurCredit_Project\\scripts\\ArnurCredit_Project.open_arnur_site.script.json"},"nextAction":{},"params":{"params":"\"{'without_GESF': {{without_GESF}}, 'path_to_edit_file': {{path_to_edit_file}}}\""},"errorPort":{"repeat":null,"delay":null},"errorAction":{}},"expanded":true,"actions":{"data":{"breakpoint":false}},"comment":"Берем ГЭСВ с сайта"},"IXRmy_SLYS":{"id":"IXRmy_SLYS","x":840,"y":120,"type":"invoce_code_script","connections":{"inputs":{"nextAction":[{"nodeId":"LZhgig-Q9h","portName":"actionPort"}]},"outputs":{"actionPort":[{"nodeId":"YQ3J7lgsgk","portName":"nextAction"}]}},"inputData":{"script":{"text":"{{without_GESF}} = {%YQ3J7lgsgk%}[0][0]\r\n{{path_to_edit_file}} = {%YQ3J7lgsgk%}[0][1]"},"nextAction":{},"errorPort":{"repeat":null,"delay":null},"errorAction":{}},"expanded":true,"actions":{"data":{"breakpoint":false}}},"TRkRLbZawK":{"id":"TRkRLbZawK","x":240,"y":120,"type":"invoce_code_script","connections":{"inputs":{"nextAction":[{"nodeId":"YQ3J7lgsgk","portName":"actionPort"}]},"outputs":{"actionPort":[{"nodeId":"bvecGWKOCG","portName":"actionPort"}]}},"inputData":{"script":{"text":"from datetime import datetime, timedelta\r\n\r\ndef get_last_day_of_previous_month():\r\n    today = datetime.today()\r\n\r\n    first_day_of_current_month = today.replace(day=1)\r\n    last_day_of_previous_month = first_day_of_current_month - timedelta(days=1)\r\n\r\n    return last_day_of_previous_month.date().strftime('%d.%m.%Y')\r\n\r\ndef get_last_day_of_before_previous_month():\r\n    today = datetime.today()\r\n\r\n    first_day_of_current_month = today.replace(day=1)\r\n\r\n    last_day_of_previous_month = first_day_of_current_month - timedelta(days=1)\r\n\r\n    first_day_of_previous_month = (last_day_of_previous_month.replace(day=1)).replace(day=1)\r\n\r\n    last_day_of_before_previous_month = first_day_of_previous_month - timedelta(days=1)\r\n\r\n    return last_day_of_before_previous_month.date().strftime('%d.%m.%Y')\r\n\r\n{{last_day_of_prev_month}} = get_last_day_of_previous_month()\r\n{{last_day_of_before_prev_month}} = get_last_day_of_before_previous_month()"},"nextAction":{},"errorPort":{"repeat":null,"delay":null},"errorAction":{}},"expanded":true,"actions":{"data":{"breakpoint":false}},"comment":"Получаем даты\n"},"ae2UtQP6wB":{"id":"ae2UtQP6wB","x":1440,"y":120,"type":"script_start","connections":{"inputs":{"nextAction":[{"nodeId":"RmrQAef36R","portName":"actionPort"}]},"outputs":{"actionPort":[{"nodeId":"LZhgig-Q9h","portName":"nextAction"}]}},"inputData":{"jsonPath":{"path":"C:\\Users\\А-Бизнес\\Desktop\\Arnur_Credit\\ArnurCredit_Project\\scripts\\ArnurCredit_Project.create_lgd.script.json"},"nextAction":{},"params":{"params":"\"{ 'path_to_edit_file': {{path_to_edit_file}}, 'last_day_of_prev_month': {{last_day_of_prev_month}}, 'last_day_of_before_prev_month': {{last_day_of_before_prev_month}} }\""},"errorPort":{"repeat":null,"delay":null},"errorAction":{}},"expanded":true,"actions":{"data":{"breakpoint":false}},"comment":"LGD"},"RmrQAef36R":{"id":"RmrQAef36R","x":1740,"y":120,"type":"script_start","connections":{"inputs":{},"outputs":{"actionPort":[{"nodeId":"ae2UtQP6wB","portName":"nextAction"}]}},"inputData":{"jsonPath":{"path":"C:\\Users\\А-Бизнес\\Desktop\\Arnur_Credit\\ArnurCredit_Project\\scripts\\ArnurCredit_Project.create_pd.script.json"},"nextAction":{},"params":{"params":"\"{ 'path_to_edit_file': {{path_to_edit_file}}, 'last_day_of_prev_month': {{last_day_of_prev_month}}, 'last_day_of_before_prev_month': {{last_day_of_before_prev_month}} }\""},"errorPort":{"repeat":null,"delay":null},"errorAction":{}},"expanded":true,"actions":{"data":{"breakpoint":false}},"comment":"PD"}}