{"MNtaoa49Kj":{"x":0,"y":330,"type":"start","connections":{"inputs":{"actionPort":[{"nodeId":"OYkAaE8Wd3","portName":"actionPort"}]},"outputs":{}},"inputData":{"actionPort":{}},"expanded":true,"root":true,"actions":{"data":{}},"id":"MNtaoa49Kj"},"kZNmig1-aB":{"id":"kZNmig1-aB","x":720,"y":330,"type":"import_lib","connections":{"inputs":{"nextAction":[{"nodeId":"20u1va-rRz","portName":"actionPort"}]},"outputs":{"actionPort":[{"nodeId":"fKwPRRjF5-","portName":"nextAction"}]}},"inputData":{"lib":{"text":"shutil"},"path":{"path":""},"nextAction":{},"errorPort":{"repeat":null,"delay":null},"errorAction":{}},"expanded":true,"actions":{"data":{"breakpoint":false}}},"fKwPRRjF5-":{"id":"fKwPRRjF5-","x":450,"y":330,"type":"invoce_code_script","connections":{"inputs":{"nextAction":[{"nodeId":"kZNmig1-aB","portName":"actionPort"}]},"outputs":{"actionPort":[{"nodeId":"OYkAaE8Wd3","portName":"nextAction"}]}},"inputData":{"script":{"text":"from datetime import datetime, timedelta\r\n\r\ndef get_last_day_of_previous_month():\r\n    today = datetime.today()\r\n\r\n    first_day_of_current_month = today.replace(day=1)\r\n    last_day_of_previous_month = first_day_of_current_month - timedelta(days=1)\r\n\r\n    return last_day_of_previous_month.date().strftime('%d.%m.%Y')\r\n\r\ndef get_last_day_of_before_previous_month():\r\n    today = datetime.today()\r\n\r\n    first_day_of_current_month = today.replace(day=1)\r\n\r\n    last_day_of_previous_month = first_day_of_current_month - timedelta(days=1)\r\n\r\n    first_day_of_previous_month = (last_day_of_previous_month.replace(day=1)).replace(day=1)\r\n\r\n    last_day_of_before_previous_month = first_day_of_previous_month - timedelta(days=1)\r\n\r\n    return last_day_of_before_previous_month.date().strftime('%d.%m.%Y')\r\n\r\n{{last_day_of_prev_month}} = get_last_day_of_previous_month()\r\n{{last_day_of_before_prev_month}} = get_last_day_of_before_previous_month()"},"nextAction":{},"errorPort":{"repeat":null,"delay":null},"errorAction":{}},"expanded":true,"actions":{"data":{"breakpoint":false}},"comment":"Получаем даты\n"},"OYkAaE8Wd3":{"id":"OYkAaE8Wd3","x":180,"y":330,"type":"import_lib","connections":{"inputs":{"nextAction":[{"nodeId":"fKwPRRjF5-","portName":"actionPort"}]},"outputs":{"actionPort":[{"nodeId":"MNtaoa49Kj","portName":"actionPort"}]}},"inputData":{"lib":{"text":"os"},"path":{"path":""},"nextAction":{},"errorPort":{"repeat":null,"delay":null},"errorAction":{}},"expanded":true,"actions":{"data":{"breakpoint":false}}},"20u1va-rRz":{"id":"20u1va-rRz","x":1020,"y":330,"type":"invoce_code_script","connections":{"inputs":{},"outputs":{"actionPort":[{"nodeId":"kZNmig1-aB","portName":"nextAction"}]}},"inputData":{"script":{"text":"import os\r\nimport shutil\r\nimport pandas as pd\r\nfrom datetime import datetime\r\nfrom openpyxl import load_workbook \r\n\r\ndef copy_files(source_folder, destination_folder):\r\n    if not os.path.exists(source_folder):\r\n        print(f\"Исходная папка '{source_folder}' не существует.\")\r\n        return\r\n\r\n    if not os.path.exists(destination_folder):\r\n        os.mkdir(destination_folder)\r\n    \r\n\r\n    files = os.listdir(source_folder)\r\n\r\n    for file in files:\r\n        source_path = os.path.join(source_folder, file)\r\n        destination_path = os.path.join(destination_folder, file)\r\n        shutil.copy2(source_path, destination_path)\r\n        print(f\"Файл '{file}' скопирован в '{destination_folder}'.\")\r\n\r\n\r\nsource_folder_path = f\"{{{data_folder_path}}}\\\\{{{last_day_of_before_prev_month}}}\\\\{{{last_day_of_before_prev_month}}}\\\\PD\"\r\n\r\ndestination_folder_path = f\"{{{data_folder_path}}}\\\\{{{last_day_of_prev_month}}}\\\\PD\"\r\n\r\ncopy_files(source_folder_path, destination_folder_path)"},"nextAction":{},"errorPort":{"repeat":null,"delay":null},"errorAction":{}},"expanded":true,"actions":{"data":{"breakpoint":false}},"comment":"Копируем файлы PD\n"}}